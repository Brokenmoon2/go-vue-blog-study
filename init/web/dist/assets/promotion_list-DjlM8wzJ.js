import{_ as C}from"./gvb_table.vue_vue_type_style_index_0_lang-DLBiV87R.js";import{N as w,d as x,m as y,a as v,o as c,b as N,e as a,w as l,M as k,r as d,f as h,z as $,c as V,p as j}from"./index-C_OMfqPK.js";import{_ as q}from"./gvb_upload_image.vue_vue_type_style_index_0_lang-BGKpf9fw.js";function T(i){return w.get("/api/adverts",{params:i,headers:{Gvb_referer:location.pathname}})}const O={href:"",images:"",is_show:!1,title:""};function D(i){return w.post("/api/adverts",i)}function E(i,u){return w.put("/api/adverts/"+i.toString(),u)}const I=x({__name:"promotion_create",props:{visible:{type:Boolean},record:{}},emits:["update:visible","ok"],setup(i,{emit:u}){const f=i,r=u,e=y({href:"",images:"",is_show:!1,title:""}),m=v(void 0);function g(){Object.assign(e,f.record),m.value=f.record.id}const p=v();async function s(){if(await p.value.validate())return!1;let t;if(m.value?t=await E(m.value,e):t=await D(e),t.code){k.error(t.msg);return}k.success(t.msg),Object.assign(e,O),r("update:visible",!1),r("ok")}return(b,t)=>{const _=d("a-input"),o=d("a-form-item"),U=d("a-switch"),A=d("a-form"),B=d("a-modal");return c(),N("div",null,[a(B,{title:m.value?"编辑广告":"创建广告",visible:f.visible,onBeforeOpen:g,onCancel:t[4]||(t[4]=n=>r("update:visible",!1)),"on-before-ok":s},{default:l(()=>[a(A,{ref_key:"formRef",ref:p,model:e},{default:l(()=>[a(o,{field:"title",label:"广告名称",rules:[{required:!0,message:"请输入广告名称"}],"validate-trigger":["blur"]},{default:l(()=>[a(_,{modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=n=>e.title=n),placeholder:"广告名称"},null,8,["modelValue"])]),_:1}),a(o,{field:"href",label:"跳转链接",rules:[{required:!0,message:"请输入跳转链接"}],"validate-trigger":["blur"]},{default:l(()=>[a(_,{modelValue:e.href,"onUpdate:modelValue":t[1]||(t[1]=n=>e.href=n),placeholder:"跳转链接"},null,8,["modelValue"])]),_:1}),a(o,{field:"images",label:"图片链接",rules:[{required:!0,message:"请输入图片链接"}],"validate-trigger":["blur"]},{default:l(()=>[a(q,{modelValue:e.images,"onUpdate:modelValue":t[2]||(t[2]=n=>e.images=n)},null,8,["modelValue"])]),_:1}),a(o,{label:"是否显示"},{default:l(()=>[a(U,{modelValue:e.is_show,"onUpdate:modelValue":t[3]||(t[3]=n=>e.is_show=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","visible"])])}}}),L={class:"promotion_list_view"},z=x({__name:"promotion_list",setup(i){const u=v(),f=[{title:"标题",dataIndex:"title"},{title:"图片",slotName:"images"},{title:"链接",slotName:"href"},{title:"是否显示",slotName:"is_show"},{title:"更新时间",slotName:"created_at"},{title:"操作",slotName:"action"}],r=v(!1),e=y({href:"",images:"",is_show:!1,title:""});function m(p){Object.assign(e,p),r.value=!0}function g(){Object.assign(e,O),e.id=void 0,r.value=!0}return(p,s)=>{const b=d("a-image"),t=d("a-link"),_=d("a-tag");return c(),N("div",L,[a(I,{visible:r.value,"onUpdate:visible":s[0]||(s[0]=o=>r.value=o),record:e,onOk:s[1]||(s[1]=o=>u.value.getList())},null,8,["visible","record"]),a(C,{url:j(T),columns:f,"default-delete":"","add-label":"创建广告","no-confirm":"",ref_key:"gvbTable",ref:u,"search-placeholder":"搜索广告名称",onAdd:g,onEdit:m},{images:l(({record:o})=>[a(b,{height:"80px",style:{"border-radius":"5px"},src:o.images},null,8,["src"])]),href:l(({record:o})=>[a(t,{href:o.href,target:"_blank"},{default:l(()=>[h($(o.href),1)]),_:2},1032,["href"])]),is_show:l(({record:o})=>[o.is_show?(c(),V(_,{key:0,color:"arcoblue"},{default:l(()=>s[2]||(s[2]=[h("显示")])),_:1})):(c(),V(_,{key:1},{default:l(()=>s[3]||(s[3]=[h("不显示")])),_:1}))]),_:1},8,["url"])])}}});export{z as default};
