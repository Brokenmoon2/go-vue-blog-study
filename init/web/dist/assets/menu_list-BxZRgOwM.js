import{N as U,d as y,a as V,m as h,o as f,b as L,e as l,w as n,g,F as N,v as O,M as S,r as d,c as A,f as R,z as F,p as M}from"./index-C_OMfqPK.js";import{_ as q}from"./gvb_table.vue_vue_type_style_index_0_lang-DLBiV87R.js";import{i as z}from"./image_api-mDpDKLVJ.js";function D(u){return U.get("/api/menus",{params:u})}function E(u){return U.post("/api/menus",u)}function H(u,p){return U.put("/api/menus/"+u.toString(),p)}const B={abstract:[],abstract_time:7,banner_time:7,image_sort_list:[],path:"",slogan:"",sort:1,title:"",abstractString:"",imageIdList:[]},G={class:"banner_image_div"},J=["src"],K=y({__name:"menu_create",props:{visible:{type:Boolean},record:{}},emits:["update:visible","ok"],setup(u,{emit:p}){const s=u,I=V([]);async function c(){let i=await z();I.value=i.data}c();const v=p,e=h({abstract:[],abstract_time:7,banner_time:7,image_sort_list:[],path:"",slogan:"",sort:1,title:"",abstractString:"",imageIdList:[]}),m=V(void 0);function b(){Object.assign(e,s.record),e.abstractString=s.record.abstract.join(`
`);const i=[];for(const t of s.record.banners)i.push(t.id);e.imageIdList=i,m.value=s.record.id}const x=V();async function _(){if(await x.value.validate())return!1;e.abstract=e.abstractString.split(`
`);let t=[];for(let o=0;o<e.imageIdList.length;o++){const k=e.imageIdList[o];t.push({image_id:k,sort:e.imageIdList.length-o})}e.image_sort_list=t;let r;if(m.value?r=await H(m.value,e):r=await E(e),r.code){S.error(r.msg);return}S.success(r.msg),Object.assign(e,B),v("update:visible",!1),v("ok")}return(i,t)=>{const r=d("a-input"),o=d("a-form-item"),k=d("a-textarea"),w=d("a-input-number"),$=d("a-option"),j=d("a-select"),C=d("a-form"),T=d("a-modal");return f(),L("div",null,[l(T,{title:m.value?"编辑菜单":"创建菜单",visible:s.visible,onBeforeOpen:b,onCancel:t[8]||(t[8]=a=>v("update:visible",!1)),"on-before-ok":_},{default:n(()=>[l(C,{ref_key:"formRef",ref:x,model:e},{default:n(()=>[l(o,{field:"title",label:"菜单标题",rules:[{required:!0,message:"请输入菜单标题"}],"validate-trigger":["blur"]},{default:n(()=>[l(r,{modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=a=>e.title=a),placeholder:"菜单标题"},null,8,["modelValue"])]),_:1}),l(o,{field:"path",label:"菜单路径",rules:[{required:!0,message:"请输入菜单路径"}],"validate-trigger":["blur"]},{default:n(()=>[l(r,{modelValue:e.path,"onUpdate:modelValue":t[1]||(t[1]=a=>e.path=a),placeholder:"菜单路径"},null,8,["modelValue"])]),_:1}),l(o,{label:"slogan"},{default:n(()=>[l(r,{modelValue:e.slogan,"onUpdate:modelValue":t[2]||(t[2]=a=>e.slogan=a),placeholder:"slogan"},null,8,["modelValue"])]),_:1}),l(o,{label:"简介"},{default:n(()=>[l(k,{modelValue:e.abstractString,"onUpdate:modelValue":t[3]||(t[3]=a=>e.abstractString=a),placeholder:"简介","auto-size":{minRows:2,maxRows:2}},null,8,["modelValue"])]),_:1}),l(o,{label:"bannerT"},{extra:n(()=>t[9]||(t[9]=[g("div",null,"banner图的切换时间",-1)])),default:n(()=>[l(w,{modelValue:e.banner_time,"onUpdate:modelValue":t[4]||(t[4]=a=>e.banner_time=a),placeholder:"banner切换时间"},null,8,["modelValue"])]),_:1}),l(o,{label:"abstractT"},{extra:n(()=>t[10]||(t[10]=[g("div",null,"简介内容的切换时间",-1)])),default:n(()=>[l(w,{modelValue:e.abstract_time,"onUpdate:modelValue":t[5]||(t[5]=a=>e.abstract_time=a),placeholder:"简介切换时间"},null,8,["modelValue"])]),_:1}),l(o,{label:"序号"},{extra:n(()=>t[11]||(t[11]=[g("div",null,"序号大的在前面",-1)])),default:n(()=>[l(w,{modelValue:e.sort,"onUpdate:modelValue":t[6]||(t[6]=a=>e.sort=a),placeholder:"序号"},null,8,["modelValue"])]),_:1}),l(o,{label:"banner图"},{default:n(()=>[l(j,{modelValue:e.imageIdList,"onUpdate:modelValue":t[7]||(t[7]=a=>e.imageIdList=a),multiple:"",placeholder:"选择banner图","allow-clear":""},{default:n(()=>[(f(!0),L(N,null,O(I.value,a=>(f(),A($,{value:a.id,key:a.id},{default:n(()=>[g("div",G,[g("img",{height:"40",src:a.path,alt:""},null,8,J),R(" "+F(a.name),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","visible"])])}}}),P={class:"menu_list_view"},Q={class:"menu_column_image"},Z=y({__name:"menu_list",setup(u){const p=V(),s=h({abstract:[],abstract_time:7,banner_time:7,image_sort_list:[],path:"",slogan:"",sort:1,title:"",banners:[]}),I=[{title:"序号",dataIndex:"sort"},{title:"菜单标题",dataIndex:"title"},{title:"路径",dataIndex:"path"},{title:"slogan",dataIndex:"slogan"},{title:"简介",dataIndex:"abstract"},{title:"slogan切换时间",dataIndex:"banner_time"},{title:"简介切换时间",dataIndex:"abstract_time"},{title:"banner",slotName:"banners"},{title:"更新时间",slotName:"created_at"},{title:"操作",slotName:"action"}],c=V(!1);function v(m){Object.assign(s,m),c.value=!0}function e(){Object.assign(s,B),s.id=void 0,s.banners=[],c.value=!0}return(m,b)=>{const x=d("a-image");return f(),L("div",P,[l(K,{visible:c.value,"onUpdate:visible":b[0]||(b[0]=_=>c.value=_),onOk:b[1]||(b[1]=_=>p.value.getList()),record:s},null,8,["visible","record"]),l(q,{url:M(D),columns:I,"default-delete":"","add-label":"创建菜单","no-confirm":"",ref_key:"gvbTable",ref:p,"no-page":"","no-check":"","no-action-group":"","search-placeholder":"搜索菜单名称",onAdd:e,onEdit:v},{banners:n(({record:_})=>[g("div",Q,[(f(!0),L(N,null,O(_.banners,i=>(f(),A(x,{height:"40px",key:i.id,src:i.path},null,8,["src"]))),128))])]),_:1},8,["url"])])}}});export{Z as default};
