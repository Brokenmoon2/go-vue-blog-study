import{_ as pe,d as ae,i as me,j as ee,k as ve,o as r,b as k,n as ye,l as he,g as G,R as _e,a5 as I,a as R,m as Q,e as $,w as u,f as K,z as te,p as L,A as B,c as g,F as O,a2 as ge,a6 as T,v as oe,M as Y,a7 as ke,a8 as be,r as D,y as we,a9 as Ce}from"./index-C_OMfqPK.js";const $e=ae({name:"IconRefresh",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:o=>["butt","round","square"].includes(o)},strokeLinejoin:{type:String,default:"miter",validator:o=>["arcs","bevel","miter","miter-clip","round"].includes(o)},rotate:Number,spin:Boolean},emits:{click:o=>!0},setup(o,{emit:v}){const s=me("icon"),n=ee(()=>[s,`${s}-refresh`,{[`${s}-spin`]:o.spin}]),b=ee(()=>{const d={};return o.size&&(d.fontSize=ve(o.size)?`${o.size}px`:o.size),o.rotate&&(d.transform=`rotate(${o.rotate}deg)`),d});return{cls:n,innerStyle:b,onClick:d=>{v("click",d)}}}}),xe=["stroke-width","stroke-linecap","stroke-linejoin"],Me=G("path",{d:"M38.837 18C36.463 12.136 30.715 8 24 8 15.163 8 8 15.163 8 24s7.163 16 16 16c7.455 0 13.72-5.1 15.496-12M40 8v10H30"},null,-1),Be=[Me];function De(o,v,s,n,b,m){return r(),k("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:ye(o.cls),style:he(o.innerStyle),"stroke-width":o.strokeWidth,"stroke-linecap":o.strokeLinecap,"stroke-linejoin":o.strokeLinejoin,onClick:v[0]||(v[0]=(...d)=>o.onClick&&o.onClick(...d))},Be,14,xe)}var X=pe($e,[["render",De]]);const Ge=Object.assign(X,{install:(o,v)=>{var s;const n=(s=v==null?void 0:v.iconPrefix)!=null?s:"";o.component(n+X.name,X)}});var E={exports:{}},Ne=E.exports,ne;function Se(){return ne||(ne=1,function(o,v){(function(s,n){o.exports=n()})(Ne,function(){return function(s,n,b){s=s||{};var m=n.prototype,d={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function F(a,y,w,j){return m.fromToBase(a,y,w,j)}b.en.relativeTime=d,m.fromToBase=function(a,y,w,j,f){for(var z,x,V,A=w.$locale().relativeTime||d,P=s.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],U=P.length,N=0;N<U;N+=1){var h=P[N];h.d&&(z=j?b(a).diff(w,h.d,!0):w.diff(a,h.d,!0));var C=(s.rounding||Math.round)(Math.abs(z));if(V=z>0,C<=h.r||!h.r){C<=1&&N>0&&(h=P[N-1]);var _=A[h.l];f&&(C=f(""+C)),x=typeof _=="string"?_.replace("%d",C):_(C,y,h.l,V);break}}if(y)return x;var p=V?A.future:A.past;return typeof p=="function"?p(x):p.replace("%s",x)},m.to=function(a,y){return F(a,y,this,!0)},m.from=function(a,y){return F(a,y,this)};var S=function(a){return a.$u?b.utc():b()};m.toNow=function(a){return this.to(S(this),a)},m.fromNow=function(a){return this.from(S(this),a)}}})}(E)),E.exports}var ze=Se();const Te=_e(ze);I.extend(Te);I.locale("zh-cn");function je(o){return I(o).format("YYYY-MM-DD HH:mm:ss")}function Ue(o){return I(o).format("YYYY-MM-DD")}const Ve={class:"gvb_table"},Ae={class:"gvb_table_head"},Pe={key:0,class:"action_create"},Re={key:1,class:"action_group"},Ke={class:"action_search"},Le={key:2,class:"action_filter"},Ye={class:"action_flush"},Fe={class:"gvb_table_source"},Oe={class:"gvd_cell_actions"},Ee={key:0,class:"gvb_table_page"},qe=ae({__name:"gvb_table",props:{url:{type:Function},columns:{},limit:{},rowKey:{},addLabel:{},defaultDelete:{type:Boolean},noActionGroup:{type:Boolean},actionGroup:{},noCheck:{type:Boolean},filterGroup:{},noConfirm:{type:Boolean},noAdd:{type:Boolean},noEdit:{type:Boolean},noDelete:{type:Boolean},searchPlaceholder:{},defaultParams:{},noPage:{type:Boolean}},emits:["add","edit","remove"],setup(o,{expose:v,emit:s}){const n=o,{limit:b=10,rowKey:m="id",addLabel:d="添加",searchPlaceholder:F="搜索"}=n,S=s,a=R([]),y=Q({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),w=R([{label:"批量删除",value:0}]);function j(){if(n.actionGroup)for(let t=0;t<n.actionGroup.length;t++)w.value.push({label:n.actionGroup[t].label,value:t+1,callback:n.actionGroup[t].callback})}j();const f=R(void 0);function z(){if(f.value==="")return;if(f.value===0){if(a.value.length===0){Y.warning("请选择要删除的记录");return}C(a.value);return}const t=w.value[f.value];t.callback&&t.callback(a.value).then(e=>{if(e){a.value=[],M();return}})}const x=R([]);async function V(){if(n.filterGroup)for(let t=0;t<n.filterGroup.length;t++){const e=n.filterGroup[t];let i=[];switch(typeof e.source){case"function":i=(await e.source()).data;break;case"object":i=e.source;break;case"string":i=(await ke(e.source)).data;break}x.value.push({label:e.label,value:t,column:e.column,options:i,source:e.source})}}V();function A(t,e){M({[t.column]:e})}function P(){S("add")}function U(t){S("edit",t)}const N=/return useAxios.get\("(.*?)",/;async function h(t){let e=t[m];C([e])}async function C(t){if(n.defaultDelete){let e=N.exec(n.url.toString());if(e===null||e.length!==2)return;let i=await be(e[1],t);if(i.code){Y.error(i.msg);return}Y.success(i.msg),a.value=[],M();return}S("remove",t)}const _=Q({list:[],count:0}),p=Q({page:1,limit:b,key:""}),q=R(!1);async function M(t){t&&Object.assign(p,t),q.value=!0;let e=await n.url(p);if(q.value=!1,e.code){Y.error(e.msg);return}_.list=e.data.list,_.count=e.data.count}function le(){M()}function Z(){p.page=1,M()}function re(){Y.success("刷新成功"),M()}M(n.defaultParams);function se(){_.list=[],_.count=0}return v({getList:M,clearData:se}),(t,e)=>{const i=D("a-button"),H=D("a-select"),W=D("a-popconfirm"),ie=D("a-input-search"),J=D("a-table-column"),ue=D("a-table"),ce=D("a-pagination"),de=D("a-spin");return r(),k("div",Ve,[G("div",Ae,[n.noAdd?B("",!0):(r(),k("div",Pe,[$(i,{type:"primary",onClick:P},{default:u(()=>[K(te(L(d)),1)]),_:1})])),t.noActionGroup?B("",!0):(r(),k("div",Re,[$(H,{placeholder:"操作",style:{width:"120px"},"allow-clear":"",options:w.value,modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l)},null,8,["options","modelValue"]),n.noConfirm?(r(),k(O,{key:1},[f.value!==void 0&&f.value!==""?(r(),g(i,{key:0,type:"primary",status:"danger",onClick:z},{default:u(()=>e[5]||(e[5]=[K("执行 ")])),_:1})):B("",!0)],64)):(r(),g(W,{key:0,content:"是否确认执行此操作?",onOk:z},{default:u(()=>[f.value!==void 0&&f.value!==""?(r(),g(i,{key:0,type:"primary",status:"danger"},{default:u(()=>e[4]||(e[4]=[K("执行")])),_:1})):B("",!0)]),_:1}))])),G("div",Ke,[$(ie,{placeholder:L(F),modelValue:p.key,"onUpdate:modelValue":e[1]||(e[1]=l=>p.key=l),onKeydown:ge(Z,["enter"]),onSearch:Z},null,8,["placeholder","modelValue"])]),T(t.$slots,"action_other_search"),x.value.length?(r(),k("div",Le,[(r(!0),k(O,null,oe(x.value,l=>(r(),g(H,{placeholder:l.label,options:l.options,"allow-clear":"",onChange:c=>A(l,c)},null,8,["placeholder","options","onChange"]))),256))])):B("",!0),T(t.$slots,"action_slot"),G("div",Ye,[$(i,{onClick:re},{default:u(()=>[$(L(Ge))]),_:1})])]),$(de,{class:"gvb_table_data",loading:q.value,tip:"加载中"},{default:u(()=>[G("div",null,[G("div",Fe,[$(ue,{"row-key":L(m),columns:n.columns,data:_.list,"row-selection":n.noCheck?void 0:y,selectedKeys:a.value,"onUpdate:selectedKeys":e[2]||(e[2]=l=>a.value=l),pagination:!1},{columns:u(()=>[(r(!0),k(O,null,oe(n.columns,l=>(r(),k(O,null,[l.render?(r(),g(J,{key:0,title:l.title},{cell:u(c=>[(r(),g(we(l.render(c))))]),_:2},1032,["title"])):l.slotName?(r(),g(J,{key:2,title:l.title},Ce({_:2},[l.slotName==="action"?{name:"cell",fn:u(({record:c})=>[G("div",Oe,[T(t.$slots,"action_left",{record:c}),n.noEdit?B("",!0):(r(),g(i,{key:0,type:"primary",onClick:fe=>U(c)},{default:u(()=>e[6]||(e[6]=[K("编辑")])),_:2},1032,["onClick"])),T(t.$slots,"action_middle",{record:c}),n.noDelete?B("",!0):(r(),g(W,{key:1,content:"是否确认删除?",onOk:fe=>h(c)},{default:u(()=>[$(i,{status:"danger",type:"primary"},{default:u(()=>e[7]||(e[7]=[K("删除")])),_:1})]),_:2},1032,["onOk"])),T(t.$slots,"action_right",{record:c})])]),key:"0"}:l.slotName==="created_at"?{name:"cell",fn:u(({record:c})=>[G("span",null,te(L(je)(c.created_at)),1)]),key:"1"}:{name:"cell",fn:u(({record:c})=>[T(t.$slots,l.slotName,{record:c})]),key:"2"}]),1032,["title"])):(r(),g(J,{key:1,title:l.title,"data-index":l.dataIndex},null,8,["title","data-index"]))],64))),256))]),_:3},8,["row-key","columns","data","row-selection","selectedKeys"])]),n.noPage?B("",!0):(r(),k("div",Ee,[$(ce,{total:_.count,onChange:le,current:p.page,"onUpdate:current":e[3]||(e[3]=l=>p.page=l),"default-page-size":p.limit,"show-total":"","show-jumper":""},null,8,["total","current","default-page-size"])]))])]),_:3},8,["loading"])])}}});export{qe as _,je as a,Ue as d};
