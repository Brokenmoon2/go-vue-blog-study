import{d as x,a as y,o as r,b as l,F as V,v as $,r as C,n as I,g as s,e as g,w as A,f as z,z as f,N as w,m as k,a2 as B,A as N}from"./index-C_OMfqPK.js";const M={class:"gvb_message_list"},b=["onClick"],L=["src"],E={class:"nickName"},F={class:"count"},U=x({__name:"gvb_message_list",props:{data:{}},emits:["check"],setup(n,{emit:e}){const d=n,u=e,m=y(0);function h(o){m.value=o.userID,u("check",o)}return(o,D)=>{const c=C("a-typography-paragraph");return r(),l("div",M,[(r(!0),l(V,null,$(d.data,_=>(r(),l("div",{class:I({item:!0,active:m.value===_.userID}),onClick:a=>h(_)},[s("img",{class:"avatar",src:_.avatar,alt:""},null,8,L),s("div",E,[g(c,{ellipsis:{rows:1,showTooltip:!0,css:!0}},{default:A(()=>[z(f(_.nickName),1)]),_:2},1024)]),s("div",F,f(_.count),1)],10,b))),256))])}}});function K(n){return w.get("/api/message_users",{params:n})}function R(n){return w.get("/api/message_users/user",{params:{userID:n}})}function S(n,e){return w.get("/api/message_users/record",{params:{sendUserID:n,revUserID:e}})}const T={class:"message_list_view"},j={class:"user_list_menu"},q={class:"head"},G={class:"page"},H={key:0,class:"user_menu"},J={key:1,class:"user_record_menu"},O=["src"],P={class:"message-main"},Q={class:"message-user"},W={class:"message-content"},X={class:"content"},Y={class:"txt-message"},ss=x({__name:"message_list",setup(n){const e=k({page:1,limit:10,nickName:void 0}),d=k({list:[],count:0}),u=k({list:[],count:0}),m=y(0),h=y(0);async function o(){let a=await K(e);d.list=a.data.list,d.count=a.data.count}o();async function D(a){u.list=[],c.list=[];let t=await R(a.userID);u.list=t.data.list,u.count=t.data.count,m.value=a.userID}const c=k({list:[],count:0});async function _(a){h.value=a.userID,c.list=[];let t=await S(m.value,h.value);const v=[];t.data.list.forEach(p=>{p.isMe=p.send_user_id===m.value,v.push(p)}),c.list=v.reverse(),c.count=t.data.count}return(a,t)=>{const v=C("a-input-search"),p=C("a-pagination");return r(),l("div",T,[s("div",j,[s("div",q,[g(v,{placeholder:"搜索用户名",modelValue:e.nickName,"onUpdate:modelValue":t[0]||(t[0]=i=>e.nickName=i),onSearch:o,onKeydown:B(o,["enter"])},null,8,["modelValue"])]),g(U,{onCheck:D,data:d.list},null,8,["data"]),s("div",G,[g(p,{simple:"",total:d.count,onChange:o,current:e.page,"onUpdate:current":t[1]||(t[1]=i=>e.page=i),"page-size":e.limit},null,8,["total","current","page-size"])])]),u.list.length?(r(),l("div",H,[g(U,{onCheck:_,data:u.list},null,8,["data"])])):N("",!0),c.list.length?(r(),l("div",J,[(r(!0),l(V,null,$(c.list,i=>(r(),l("div",{class:I({message:!0,isMe:i.isMe})},[s("img",{class:"avatar",src:i.send_user_avatar,alt:""},null,8,O),s("div",P,[s("div",Q,f(i.send_user_nick_name),1),s("div",W,[s("div",X,[s("div",Y,f(i.content),1)])])])],2))),256))])):N("",!0)])}}});export{ss as default};
